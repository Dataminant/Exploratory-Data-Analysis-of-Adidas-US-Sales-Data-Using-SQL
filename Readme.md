# Exploratory Data Analysis of Adidas US Sales Dataset Using SQL

## Processes:
Given that the dataset was in Microsoft Excel CSV format, I had to import the CSV file into SQL Server Management Studio (SSMS) in order to perform data cleaning and manipulation to ensure I have an accurate and consistent data, also to improve the quality and reliability of the data for analysis.

## Changing the table name 
-- Changing the table name 

EXEC sp_rename 'Sales', 'TheDataminant_Sales' ;


======================================================================================================

-- Checking for NULL in the dataset

SELECT 
    SUM(CASE WHEN retailer IS NULL THEN 1 ELSE 0 END) AS retailer_null_count,
	SUM(CASE WHEN retailer_id IS NULL THEN 1 ELSE 0 END) AS retailer_id_null_count,
	SUM(CASE WHEN invoice_date IS NULL THEN 1 ELSE 0 END) AS invoice_date_null_count,
	SUM(CASE WHEN region IS NULL THEN 1 ELSE 0 END) AS region_null_count,
    SUM(CASE WHEN state IS NULL THEN 1 ELSE 0 END) AS state_null_count,
    SUM(CASE WHEN city IS NULL THEN 1 ELSE 0 END) AS city_null_count,
    SUM(CASE WHEN product IS NULL THEN 1 ELSE 0 END) AS product_null_count,
    SUM(CASE WHEN price_per_unit IS NULL THEN 1 ELSE 0 END) AS price_per_unit_null_count,
    SUM(CASE WHEN units_sold IS NULL THEN 1 ELSE 0 END) AS units_sold_null_count,
    SUM(CASE WHEN total_sales IS NULL THEN 1 ELSE 0 END) AS total_sales_null_count,
    SUM(CASE WHEN operating_profit IS NULL THEN 1 ELSE 0 END) AS operating_profit_null_count,
    SUM(CASE WHEN operating_margin IS NULL THEN 1 ELSE 0 END) AS operating_margin_null_count,
    SUM(CASE WHEN sales_method IS NULL THEN 1 ELSE 0 END) AS sales_method_null_count

FROM dbo.TheDataminant_Sales



======================================================================================================

-- What is the total revenue generated?

SELECT SUM(total_sales) AS total_sales
FROM dbo.TheDataminant_Sales


======================================================================================================

-- What is the total revenue generated by year?

SELECT DATENAME (YEAR, invoice_date), SUM(total_sales) AS total_revenue
FROM dbo.TheDataminant_Sales
GROUP BY DATENAME (YEAR, invoice_date)

======================================================================================================

-- What is the average daily sales value by retailer?

SELECT retailer, ROUND(AVG(total_sales), 0) AS average_daily_sales
FROM dbo.TheDataminant_Sales
GROUP BY retailer
ORDER BY AVG(total_sales) DESC

======================================================================================================

-- What is the average daily sales value by retailer by year?

-- 2020
SELECT retailer, ROUND(AVG(total_sales), 0) AS average_daily_sales
FROM dbo.TheDataminant_Sales
WHERE DATENAME (YEAR, invoice_date ) = 2020
GROUP BY retailer
ORDER BY AVG(total_sales) DESC


--2021

SELECT retailer, ROUND(AVG(total_sales), 0) AS average_daily_sales
FROM dbo.TheDataminant_Sales
WHERE DATENAME (YEAR, invoice_date ) = 2021
GROUP BY retailer
ORDER BY AVG(total_sales) DESC

======================================================================================================

-- What is the 2nd best sales method by sales total?

SELECT  sales_method, SUM(total_sales) AS sales_total
FROM dbo.TheDataminant_Sales
GROUP BY sales_method
ORDER BY SUM(total_sales) DESC
OFFSET 1 ROWS
FETCH FIRST 1 ROWS ONLY;

======================================================================================================

-- Which categories of product are the most popular (footwear/apparel)?

SELECT product_by_categories, SUM (units_sold) AS total_units_sold
FROM (
       SELECT 
             CASE WHEN  product LIKE '%Footwear' THEN 'Footwear'
		  WHEN product LIKE '%Apparel' THEN 'Apparel'
             END AS product_by_categories, units_sold
       FROM dbo.TheDataminant_Sales
) 
AS product_by_categories
GROUP BY  product_by_categories
ORDER BY SUM (units_sold) DESC

======================================================================================================

-- Which is most purchased between men’s and women’s product?

SELECT product_by_gender, SUM (units_sold) AS total_units_sold
FROM (
       SELECT 
             CASE WHEN  product LIKE 'Men%' THEN 'Men'
		  WHEN product LIKE 'Women%' THEN 'Women'
             END AS product_by_gender, units_sold
       FROM dbo.TheDataminant_Sales
) 
AS product_by_gender
GROUP BY  product_by_gender
ORDER BY SUM (units_sold) DESC

======================================================================================================

-- What is the profit margin for different product?

SELECT OM2020.product, 
       OM2020.[2020_operating_margin], 
	   OM2021.[2021_operating_margin]
FROM
    (SELECT
         Product, 
		 AVG(operating_profit / NULLIF(total_sales, 0) * 100) AS '2020_operating_margin'
     FROM dbo.TheDataminant_Sales
     WHERE DATENAME (YEAR, invoice_date) = '2020'
     GROUP BY product ) AS OM2020
JOIN
    (SELECT
         Product, 
		 AVG(operating_profit / NULLIF(total_sales, 0) * 100) AS '2021_operating_margin'
     FROM dbo.TheDataminant_Sales
     WHERE DATENAME (YEAR, invoice_date) = '2021'
     GROUP BY product ) AS OM2021
ON OM2020.product = OM2021.product ;

 

======================================================================================================

--What is the difference in profitability by sales methods?

SELECT sales_method, ROUND(AVG(operating_margin * 100),0) AS operating_margin
FROM dbo.TheDataminant_Sales
GROUP BY sales_method
ORDER BY operating_margin DESC







